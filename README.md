# Malicious Behavior Detection using Windows Audit Logs

This is the github page for the AI-Sec 2015 publication "Malicious Behavior Detection using Windows Audit Logs" by Konstantin Berlin, David Slater, and Joshua Saxe.

__If you have any questions or issues, or something is not clear about our data or scripts, please report them, so we can fix them as soon as possible.__

###Synoposis:

We investigated the utility of agentless detection of malicious endpoint behavior, using only the standard build-in Windows audit logging facility as our signal. We found that Windows audit logs, while emitting manageable sized data streams on the endpoints, provide enough information to allow robust detection of malicious behavior. Audit logs provide an effective, low-cost alternative to deploying additional expensive agent-based breach detection systems in many government and industrial settings, and can be used to detect, in our tests, 83% percent of malware samples with a 0.1% false positive rate. They can also supplement already existing host signature-based antivirus solutions, like Kaspersky, Symantec, and McAfee, detecting, in our testing environment, 78% of malware missed by those antivirus systems.

The free pre-print of the publication can be found at http://arxiv.org/abs/1506.04200.

## Data and anonymization 

The anonymized version of the data that we used to compute our results can be found [here](http://nothing). The data has been anonomized in order to protect the privacy of the users from which it was collected.

The goal of the anonymization was not only to protect privacy, but also allow the security community to supplement and reuse our data for their own needs. Therefore, part of our data has been anonymized such that if a new set of audit logs are added created by someone, it can be added to our dataset without duplicating feature names.

The following is the description of the anonymization steps

* step 1
* step 2
* step 3
* step 4

### Regex Transformations

The regex transformations that we use to generate our feature labels are located in the [regex file](regex.txt). The regex expressions must be executed in order listed to reproduce our results.

## Build

In order to reproduce the plots from the paper using our MATLAB scripts you will you will need MATLAB 2014 or higher, with Statistics and Machine Learning Toolbox.

To load the data from disk into MATLAB type:

```
load_data(<dir>)
```


