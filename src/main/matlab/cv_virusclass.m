function [I] = cv_virusclass(y, virus_label, kfold)

  for iter=1:length(virus_label)
    x = strsplit(virus_label{iter},'.');
    virus_label{iter} = lower(x{1});
    x = strsplit(virus_label{iter},'-');
    virus_label{iter} = lower(x{1});
  end

  n = randperm(length(y));
  y = y(n);
  virus_label = virus_label(n);

  [label,~,z] = unique(virus_label);
  %d = hist(z,length(label));
  label
  
  
  %bad index
  idx = find(strcmp(label,'<nolabel>'));

  %get the good labels
  idx_good = find(y==0)';
  s_good = round(length(idx_good)/kfold);
    
  %split into kfolds
  s = round(length(label)/kfold); 
    
  iter =1;
  for ii = 1:s:length(label)
    exl_index = ii:min(length(label),(ii+s-1));
    
    %now the training index
    I_part{iter} = ~ismember(z', [exl_index, idx]) & y'>0;
    
    iter = iter+1;
  end
  
  iter =1;
  for ii = 1:s_good:length(idx_good)
    
    exl_index = ii:min(length(idx_good),(ii+s_good-1));    
    exl_index = ismember(1:length(idx_good), exl_index);
    
    I_part{iter} = I_part{iter} | ismember(1:length(y), idx_good(~exl_index));
    
    iter = iter+1;
  end
  
  %get back the order
  for iter=1:length(I_part)    
    x = I_part{iter};
    x(n) = I_part{iter};
    I{iter} = x;
  end
  